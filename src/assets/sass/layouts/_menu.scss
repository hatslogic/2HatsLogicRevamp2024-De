$delay-step: 0.05s; // Define the step for delay
$transform-duration: 0.3s;
$opacity-duration: 0.3s;
$elements-count: 6;
$traslate-y: 10px;
$transition-timing-function: ease-in-out;

// Define the mixin to generate transition delay for nth child
@mixin transition-delay($num) {
    transition-delay: $num * $delay-step;
}

.main-menu{
    
    a{
        text-decoration: none;
        color: var(--c-secondary);
        transition: 0.25s all;
    }

    @include above($md){
        & > li{
            a{
                &:hover{
                    color: var(--c-primary);
                }
            }
            & > a{
                border-color: transparent;
            }
            & > ul{
                box-shadow: 0px rem(8) rem(8) rgba(0,0,0,.05);
                visibility: hidden;
                opacity: 0;
            }
            &.compact{
                & > ul{
                    box-shadow: none;
                    & > .container{
                        box-shadow: 0px rem(8) rem(8) rgba(0,0,0,.05);
                    }
                }
            }
            &:hover{
                & > a{
                    color: var(--c-primary);
                }
            }
            &.active, &:not(.has-child):hover{
                & > a{
                    border-color: var(--c-primary);
                }
            }
            &:hover{
                & > a{
                    color: var(--c-primary);
                }
                & > ul{
                    visibility: visible;
                    opacity: 1;
                }
            }
        }
    }

    @include below($md){
        .icon-expand_more{
            pointer-events: none;
        }
        & > .has-child{
            & > ul{
                // display: none;
                transition: max-height 0.3s ease-in-out;
                overflow: hidden;
                max-height: 0;
            }
            &.active{
                & > a{
                    color: var(--c-primary);
                }
                & > ul{
                    display: block;
                    max-height: 1000px;
                }
                .icon-expand_more{
                    transform: rotate(180deg);
                }
            }
        }
    }
}

.top-menu{
    @include below($md){
        visibility: hidden;
        opacity: 0;
        background-color: var(--c-white);
        max-height: 100vh;
        overflow-y: auto;
        .main-menu{
            // transition: 0.5s all ease-in-out;
            & > li{
                transition: $transform-duration all ease-in-out;
                transform: translateY($traslate-y);
                visibility: hidden;
                opacity: 0;

                @for $i from 1 through $elements-count {
                    &:nth-child(#{$i}) {
                        @include transition-delay($i);
                    }
                }
            }
        }
    }
    &.active{
        visibility: visible;
        opacity: 1;
        .main-menu{
            & > li{
                transform: translateY(0);
                visibility: visible;
                opacity: 1;
            }
        }
    }
}

.arrow-top{
    @include above($md){
        &:before {
            content: "";
            position: absolute;
            height: 0;
            border-style: solid;
            border-width: 1.25rem 1.25rem 0 0;
            border-color: var(--c-white) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0);
            transform: rotate(45deg);
            left: rem(60);
            top: rem(10);
            display: block;
            margin-left: rem(-12);
            z-index: 0;
        }
    }
}
@media (min-width: 1024px) {
    .top-menu {
        >ul.main-menu>li {
            >ul> {

                /* container -> 4 columns, with gaps matching your design */
                .menu-columns {
                    display: block;
                    -webkit-column-count: 4;
                    -moz-column-count: 4;
                    column-count: 4;

                    -webkit-column-gap: 30px;
                    -moz-column-gap: 30px;
                    column-gap: 30px;
                    > li > ul{
                        margin-top: 12px;
                        line-height: 0;
                        & > li + li{
                            margin-top: 12px;
                        }
                    }
                    a{
                        line-height: 1.4;
                    }
                }

                /* each depth-1 should occupy full column width */
                .menu-columns>.depth-1 {
                    /* inline-block + width:100% prevents column-splitting and ensures block-like layout */
                    width: 100%;
                    vertical-align: top;

                    /* avoid splitting an element across columns */
                    break-inside: avoid;
                    -webkit-column-break-inside: avoid;
                    page-break-inside: avoid;

                    /* remove bottom margin that can create white gaps (adjust if you need spacing) */
                    margin: 0 0 0 0;
                    padding: 0;
                }

                .menu-columns > .depth-1:nth-child(1),
                .menu-columns > .depth-1:nth-child(2) {
                    height: 100%;
                }

                .menu-columns > .depth-1:nth-child(4),
                .menu-columns > .depth-1:nth-child(3),
                .menu-columns > .depth-1:nth-child(6) {
                    margin-top: 40px; // adjust spacing as needed
                }

                /* force these children to start a NEW column:
            - nth-child(2) → column 2
            - nth-child(3) → column 3 (so 3 + 4 are in same column)
            - nth-child(5) → column 4 (so 5 + 6 are in same column) */
                .menu-columns>.depth-1:nth-child(2),
                .menu-columns>.depth-1:nth-child(3),
                .menu-columns>.depth-1:nth-child(5) {
                    break-before: column;
                    -webkit-column-break-before: always;
                    page-break-before: always;
                }
            }
        }
    }
}

@media (max-width: 1023px) {
    .top-menu {
        >ul.main-menu>li {
            >ul {

                /* container -> 4 columns, with gaps matching your design */
                .menu-columns {
                    display: flex;
                }
            }
        }
    }
    .main-menu a {
        line-height: 1.35;
    }
}